<html>
  <head>
    <title>Test page for Docx Splitter</title>
    <script>
      function postFormData() {
          const fileInput = document.querySelector('#docx');
          const form = document.querySelector('#form');
          const formData = new FormData();
          var foo = fileInput.files[0];
          var fileName = foo.name;
	  var key = document.getElementById("key").value;
	  var authkey = "Basic "  + key
          formData.set('docx', foo);
	  console.log(fileName,fileInput.files.length,foo);
	  console.log(formData.get("docx"));
          const options = {
              method: 'POST',
              body: formData,
              headers:
              {
		  'Authorization': authkey
              }
          };

          fetch('/api/docxToHTMLSync', options)
              .then(response => response.json())
              .then(data => {
		  console.log('Success:', data);
		  var iframe = document.querySelector("#xsweet");
		  iframe.srcdoc = data["html"];
              })
              .catch((error) => {
		  console.error('Error:', error);
              });
      }
      function getAuth() {
	  var authkey = "Basic NTlhMzM5MmItMGM0Zi00MzE4LWJiZTItZjg2ZWZmNmQzZGU0OmFzbGRrakxLSkxhc2xrZGY4OTdramhLVUpI";
          const options = {
              method: 'POST',
              headers:
              {
		  'Authorization': authkey
              }
          };
          fetch('/api/auth', options)
              .then(response => response.json())
              .then(data => {
		  console.log('Success:', data);
		  var key = document.querySelector("#key");
		  key.value = data["accessToken"];
              })
              .catch((error) => {
		  console.error('Error:', error);
              });
      }
    </script>
  </head>
  <body>
    <h1>Test page for Docx Splitter</h1>
    <p>Load Docx file for splitting here:</p>
    <input id="docx" type="file" onLoad="" name="docx" accept=".docx">
    <br>
    <button onClick="getAuth();">Get Key</button>: <input type="textbox" id="key" size="100" plaeholder="Paste/Type authorization key here ..."  /><br>
    <input type="button" id="post" onClick="postFormData();" value="OpenFile" />
    <iframe id="xsweet" width="100%" height="100%" srcdoc="Docx content to load here ..."></iframe>
  </body>
</html>
