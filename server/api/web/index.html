<html>
  <head>
    <title>Test page for Docx Splitter</title>
    <script>
      function postFormData() {
          const fileInput = document.querySelector('#docx');
          const form = document.querySelector('#form');
          const formData = new FormData();
          var foo = fileInput.files[0];
          var fileName = foo.name;
          formData.set('docx', foo);
	  console.log(fileName,fileInput.files.length,foo);
	  console.log(formData.get("docx"));
          const options = {
              method: 'POST',
              body: formData,
              headers:
              {
		  'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7ImNsaWVudElkIjoiNTlhMzM5MmItMGM0Zi00MzE4LWJiZTItZjg2ZWZmNmQzZGU0In0sImlhdCI6MTY0OTQyMTc1NCwiZXhwIjoxNjc4MjIxNzU0fQ.ZJALleUcAyUmPSB_wryNbihSe-KlxByYPbATJm0NFPM'
              }
          };

          fetch('/api/docxToHTMLSync', options)
              .then(response => response.json())
              .then(data => {
		  console.log('Success:', data);
		  var iframe = document.querySelector("#xsweet");
		  iframe.srcdoc = data["html"];
              })
              .catch((error) => {
		  console.error('Error:', error);
              });
      }
    </script>
  </head>
  <body>
    <h1>Test page for Docx Splitter</h1>
    <p>Load Docx file for splitting here:</p>
    <input id="docx" type="file" onLoad="" name="docx" accept=".docx">
    <br>
    <input type="button" id="post" onClick="postFormData();" value="OpenFile" />
    <iframe id="xsweet" width="100%" height="100%" srcdoc="Docx content to load here ..."></iframe>
  </body>
</html>
